// Nextflow configuration file for development best practices

// Global parameters
params {
    input = 'data/sample_data.csv'
    output = 'results'
    publish_dir_mode = 'copy'
}

// Process-specific configurations
process {
    // Default resource requirements
    cpus = 1
    memory = '2.GB'
    time = '1.h'

    // Process-specific settings
    withName: 'processSample' {
        cpus = 1
        memory = '1.GB'
        container = 'ubuntu:latest'
    }

    withName: 'heavyProcess' {
        cpus = 4
        memory = '8.GB'
        time = '2.h'
        container = 'ubuntu:latest'
    }

    // Error handling
    errorStrategy = 'retry'
    maxRetries = 2
}

// Execution profiles
profiles {
    test {
        params.input = 'data/sample_data.csv'
        params.output = 'test_results'
        process.executor = 'local'
    }

    dev {
        params.output = 'dev_results'
        process.executor = 'local'
        // Enable debugging features
        trace.enabled = true
        timeline.enabled = true
        report.enabled = true
    }

    cluster {
        process.executor = 'slurm'
        process.queue = 'compute'
        process.clusterOptions = '--partition=normal'
    }

    docker {
        docker.enabled = true
        docker.userEmulation = true
    }

    singularity {
        singularity.enabled = true
        singularity.autoMounts = true
    }
}

// Report configuration
trace {
    enabled = true
    file = "${params.output}/trace.txt"
}

timeline {
    enabled = true
    file = "${params.output}/timeline.html"
}

report {
    enabled = true
    file = "${params.output}/report.html"
}

// Manifest
manifest {
    name = 'Development Best Practices'
    description = 'Example workflows for learning Nextflow development best practices'
    version = '1.0.0'
    nextflowVersion = '>=21.10.0'
}
